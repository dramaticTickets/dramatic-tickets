# 软件设计文档

---
## 前言

项目涉及到了安卓前端和服务器后端两个部分，我们采用了前后端分离的设计开发思路。前后端分离同时开发可以使分工更加明确，提高开发效率，也提高了软件的可扩展性和可维护性。具体的实现方法是通过小组前后端人员共同的讨论和商量，设计出一套前端所需要使用的restful API。随后的具体开发中，前端只需要适时的调用所需的API，就可以实现对数据的获取和修改等操作；而后端则只需要专注于数据库的设计实现和每个restful API的实现。下面具体的设计我们分为了安卓前端和服务器后端两个部分来陈述。

---

## 安卓前端

### 技术选型理由


### 架构设计


### 模块划分


### 设计模式

---

## 服务器后端

### 技术选型理由
服务端采用的技术栈为Flask+MySQL+uWSGI+Nginx,实际操作时架设在腾讯云服务器的ubuntu环境下。

* Flask：轻量级 Web 应用框架
* MySQL：最流行的关系型数据库管理系统
* uWSGI：高效的web服务器，实现了WSGI协议、uwsgi、http等协议
* Nginx：高性能的负载均衡服务器

Flask 是轻量级的 Web 框架，自由、灵活，可扩展性强，第三方库的选择很多，适合快速开发，第三方库也使得 Flask 定制性高易扩展。

MySQL 是目前最流行的关系型数据库管理系统，被广泛地应用在 Internet 上的中小型网站中，它具有体积小、速度快、总体拥有成本低，此次项目涉及多张数据表，MySQL 是很好的选择。

uWSGI 实现了WSGI的所有接口，实现了WSGI协议、uwsgi、http等协议，是一个快速、自我修复、开发人员和系统管理员友好的服务器。uWSGI代码完全用C编写，效率高、性能稳定。

Nginx 是一个高性能的负载均衡服务器支持负载均衡，使改造升级的Web服务器更灵活，更高效，更安全，能够快速灵活且可靠的传送静态文件，同时能保证网站在面对恶意流量的攻击中能正常运行，从而保护应用安全。此次项目是一个电影订票系统，有非常多的静态文件如电影海报和用户头像，而且使用了多台服务器进行部署，因此使用 Nginx 实现反向代理和负载均衡。

### 架构设计
服务端开发主要涉及API的开发以及数据库系统的实现，因此主要包括两部分：
- model.py:数据库模型
- api.py:api的实现
完整的数据库模型如下图：


### 模块划分

根据以上的设计和分析，服务端可分为数据模型，API模块，其中API模块根据每个接口功能又分为用户模块，电影模块，影院模块，电影排期模块，座位模块，电影票（订单）模块。
服务端的目录结构如下：
```txt
├─venv：虚拟环境
├─Flask-Server：服务端开发的源码
│   ├─app：服务端主要代码
│   │    ├─model：数据模型
│   │    ├─database：生成初始的数据
│   │    └─api：各模块API
│   │        ├─users：用户模块
│   │        ├─movies：电影模块
│   │        ├─cinemas：影院模块
│   │        ├─movie_sessions：电影排期模块
│   │        ├─seats：座位模块
│   │        ├─tickets：电影票（订单）模块
│   ├─uwsgi.ini：uWSGI配置文件
```

### 设计模式
* 面向对象编程：应用中使用了面向对象编程的封装思想，按照业务逻辑将代码的各个模块进行了封装，包括数据模型与API模块，API模块又根据不同的功能分为6个小模块。
